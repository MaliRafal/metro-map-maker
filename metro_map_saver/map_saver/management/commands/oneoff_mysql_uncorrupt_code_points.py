import re

from django.core.management.base import BaseCommand
from map_saver.models import SavedMap

corrupted_maps = (179, 416, 510, 604, 830, 1268, 1768, 2017, 2168, 2725, 2753, 2755, 2775, 2776, 2777, 2778, 2786, 2787, 2794, 2796, 2797, 2798, 2799, 2837, 2839, 2842, 2845, 2867, 2868, 2870, 2871, 3063, 3083, 3084, 3122, 3123, 3124, 3125, 3126, 3127, 3128, 3129, 3130, 3131, 3132, 3133, 3134, 3135, 3136, 3137, 3138, 3139, 3140, 3141, 3142, 3143, 3144, 3164, 3166, 3170, 3172, 3173, 3175, 3176, 3177, 3197, 3235, 3263, 3264, 3280, 3281, 3282, 3286, 3313, 3390, 3451, 3552, 3553, 3569, 3640, 3646, 3707, 3732, 3821, 3822, 3823, 3824, 3825, 3826, 3827, 3900, 3922, 3977, 4040, 4349, 4607, 4678, 4738, 4744, 5102, 5171, 5248, 5442, 5502, 5503, 5528, 5529, 5530, 5533, 5535, 5574, 5605, 5608, 5644, 5645, 5646, 5647, 5657, 5660, 5677, 5690, 5691, 5716, 5734, 5741, 5742, 5782, 5856, 5900, 5981, 5982, 5996, 6050, 6077, 6172, 6299, 6300, 6302, 6304, 6305, 6306, 6307, 6308, 6309, 6311, 6312, 6313, 6326, 6327, 6329, 6330, 6331, 6332, 6334, 6344, 6349, 6365, 6461, 6562, 6563, 6564, 6612, 6699, 6756, 6849, 6852, 6929, 6931, 6932, 6950, 6951, 6952, 6953, 6972, 6973, 6974, 6975, 6977, 6978, 6989, 6991, 6993, 6994, 6996, 7022, 7050, 7066, 7076, 7138, 7139, 7146, 7147, 7148, 7150, 7156, 7194, 7195, 7202, 7215, 7303, 7309, 7390, 7440, 7476, 7478, 7484, 7485, 7486, 7491, 7623, 7624, 7625, 7633, 7637, 7643, 7651, 7681, 7683, 7776, 7878, 7880, 8236, 8370, 8371, 8607, 8654, 8702, 8703, 8705, 8706, 8768, 8946, 8947, 8948, 8982, 9014, 9040, 9047, 9051, 9115, 9116, 9117, 9118, 9122, 9127, 9144, 9157, 9164, 9166, 9167, 9168, 9171, 9174, 9176, 9222, 9233, 9278, 9323, 9338, 9341, 9364, 9401, 9454, 9482, 9483, 9484, 9485, 9529, 9548, 9587, 9643, 9668, 9677, 9678, 9679, 9680, 9688, 9767, 9806, 9831, 9840, 9841, 9867, 9905, 9906, 9943, 9995, 9999, 10019, 10064, 10142, 10145, 10146, 10147, 10188, 10277, 10326, 10422, 10475, 10514, 10522, 10655, 10718, 10745, 10819, 11041, 11221, 11224, 11254, 11275, 11418, 11434, 11437, 11485, 11515, 11517, 11570, 11571, 11653, 11693, 11694, 11707, 11733, 11734, 11735, 11736, 11737, 11750, 11751, 11756, 11774, 11775, 11776, 11777, 11778, 11779, 11877, 11879, 11881, 11908, 11910, 11911, 11912, 11913, 11915, 11960, 12017, 12023, 12025, 12041, 12107, 12114, 12122, 12168, 12206, 12225, 12226, 12245, 12252, 12253, 12254, 12293, 12320, 12336, 12397, 12401, 12402, 12437, 12516, 12562, 12563, 12714, 12720, 12725, 12759, 12778, 12840, 12841, 12842, 12867, 13154, 13178, 13225, 13277, 13278, 13290, 13298, 13326, 13335, 13336, 13352, 13358, 13368, 13369, 13370, 13371, 13377, 13385, 13388, 13406, 13449, 13450, 13484, 13508, 13511, 13513, 13525, 13585, 13589, 13593, 13627, 13629, 13639, 13641, 13680, 13689, 13690, 13708, 13719, 13753, 13754, 13755, 13786, 13794, 13822, 13825, 13826, 13837, 13838, 13868, 13917, 13918, 13922, 13943, 13945, 13954, 13963, 13997, 14025, 14027, 14085, 14097, 14099, 14116, 14143, 14191, 14240, 14241, 14246, 14248, 14253, 14256, 14283, 14297, 14321, 14332, 14356, 14357, 14391, 14394, 14398, 14422, 14427, 14497, 14503, 14533, 14557, 14558, 14569, 14571, 14621, 14672, 14681, 14711, 14751, 14755, 14764, 14765, 14769, 14771, 14772, 14774, 14776, 14802, 14820, 14834, 14851, 14854, 14866, 14881, 14883, 14903, 14905, 14906, 14907, 14922, 14924, 14964, 15045, 15052, 15057, 15063, 15067, 15068, 15070, 15074, 15077, 15125, 15140, 15141, 15155, 15156, 15226, 15367, 15430, 15433, 15439, 15440, 15452, 15472, 15502, 15538, 15539, 15569, 15576, 15594, 15595, 15596, 15597, 15600, 15639, 15641, 15642, 15643, 15644, 15645, 15646, 15652, 15661, 15690, 15693, 15743, 15777, 15780, 15795, 15851, 15852, 15858, 15860, 15861, 15898, 15908, 15910, 15913, 15915, 15916, 16054, 16055, 16094, 16192, 16243, 16246, 16305, 16312, 16324, 16412, 16427, 16430, 16433, 16442, 16444, 16447, 16449, 16481, 16485, 16488, 16489, 16494, 16495, 16496, 16508, 16509, 16553, 16560, 16662, 16665, 16668, 16675, 16691, 16728, 16793, 16797, 16800, 16802, 16803, 16815, 16819, 16835, 16853, 16900, 16902, 16937, 16941, 16954, 16975, 17006, 17103, 17150, 17155, 17166, 17248, 17278, 17297, 17327, 17339, 17359, 17364, 17386, 17387, 17390, 17396, 17403, 17474, 17482, 17487, 17491, 17493, 17507, 17513, 17647, 17692, 17714, 17715, 17717, 17718, 17719, 17720, 17721, 17722, 17756, 17757, 17758, 17760, 17762, 17764, 17765, 17766, 17767, 17768, 17805, 17806, 17808, 17809, 17812, 17814, 17815, 17816, 17821, 17822, 17823, 17824, 17826, 17827, 17830, 17831, 17832, 17838, 17839, 17841, 17842, 17844, 17845, 17846, 17847, 17848, 17849, 17850, 17851, 17852, 17853, 17854, 17855, 17857, 17858, 17859, 17872, 17892, 17894, 17895, 17897, 17950, 17951, 17952, 17966, 17967, 17969, 17970, 17971, 17972, 17974, 17977, 17978, 17979, 17980, 17988, 18003, 18011, 18012, 18059, 18077, 18125, 18156, 18170, 18172, 18177, 18181, 18184, 18192, 18200, 18201, 18203, 18204, 18214, 18217, 18254, 18277, 18279, 18292, 18335, 18350, 18356, 18378, 18454, 18456, 18459, 18460, 18497, 18498, 18523, 18559, 18687, 18699, 18701, 18754, 18776, 18783, 18797, 18799, 18802, 18807, 18808, 18863, 18869, 18872, 18873, 18874, 18878, 18879, 18880, 18882, 18903, 18904, 18940, 18958, 18959, 18982, 19017, 19055, 19063, 19089, 19090, 19103, 19104, 19106, 19107, 19146, 19148, 19149, 19212, 19218, 19231, 19290, 19299, 19380, 19381, 19382, 19387, 19389, 19390, 19392, 19393, 19435, 19440, 19478, 19479, 19519, 19525, 19529, 19530, 19531, 19535, 19584, 19588, 19596, 19609, 19668, 19767, 19792, 19793, 19794, 19807, 19816, 19817, 19832, 19842, 19843, 19848, 19851, 19853, 19872, 19907, 19935, 19950, 19951, 20019, 20073, 20109, 20135, 20139, 20140, 20143, 20144, 20149, 20157, 20192, 20199, 20205, 20217, 20251, 20253, 20254, 20256, 20287, 20301, 20304, 20305, 20314, 20315, 20321, 20323, 20324, 20327, 20329, 20357, 20378, 20425, 20481, 20485, 20515, 20518, 20519, 20520, 20521, 20522, 20530, 20564, 20565, 20585, 20586, 20594, 20599, 20624, 20626, 20627, 20639, 20710, 20759, 20771, 20781, 20797, 20819, 20830, 20842, 20898, 20899, 20900, 20901, 20958, 20969, 21035, 21157, 21277, 21298, 21310, 21411, 21436, 21439, 21441, 21456, 21461, 21467, 21478, 21485, 21521, 21590, 21591, 21605, 21719, 21743, 21782, 21789, 21791, 21793, 21795, 21847, 21848, 21849, 21868, 21906, 21928, 21947, 21950, 21983, 21985, 21993, 21995, 22018, 22021, 22031, 22042, 22084, 22085, 22192, 22229, 22235, 22276, 22326, 22327, 22336, 22363, 22413, 22419, 22427, 22428, 22429, 22453, 22489, 22491, 22529, 22533, 22537, 22575, 22585, 22611, 22625, 22654, 22669, 22707, 22739, 22742, 22743, 22797, 22963, 23053, 23130, 23131, 23134, 23188, 23225, 23241, 23267, 23269, 23272, 23274, 23275, 23285, 23312, 23333, 23363, 23375, 23376, 23378, 23379, 23380, 23478, 23588, 23780, 23782, 23789, 23796, 23797, 23802, 23803, 23805, 23808, 23809, 23811, 23812, 23813, 23815, 23896, 23899, 23900, 23901, 23902, 23933, 23934, 23952, 23954, 23970, 23972, 23977, 23990, 24040, 24043, 24052, 24055, 24072, 24095, 24110, 24135, 24136, 24167, 24186, 24187, 24224, 24240, 24241, 24272, 24310, 24312, 24327, 24384, 24417, 24433, 24434, 24453, 24466, 24480, 24512, 24523, 24524, 24526, 24538, 24553, 24569, 24570, 24615, 24616, 24617, 24618, 24619, 24620, 24625, 24626, 24627, 24628, 24630, 24631, 24639, 24640, 24683, 24684, 24686, 24688, 24689, 24718, 24719, 24739, 24740, 24743, 24744, 24769, 24771, 24772, 24773, 24774, 24816, 24817, 24818, 24873, 24875, 24876, 24877, 24880, 24976, 24982, 24984, 24987, 24991, 24992, 24995, 25029, 25041, 25042, 25043, 25052, 25055, 25056, 25156, 25157, 25218, 25275, 25300, 25327, 25395, 25421, 25426, 25427, 25439, 25454, 25515, 25597, 25622, 25657, 25666, 25679, 25684, 25686, 25687, 25688, 25689, 25691, 25693, 25694, 25695, 25710, 25749, 25819, 25827, 25828, 25851, 25905, 25908, 25941, 25978, 25979, 25980, 25983, 25984, 25985, 25986, 26108, 26110, 26127, 26133, 26334, 26378, 26383, 26424, 26442, 26453, 26478, 26525, 26559, 26594, 26616, 26681, 26794, 26836, 26864, 26872, 26874, 26891, 26895, 26899, 26907, 26938, 26940, 26945, 26956, 26958, 26962, 26963, 26970, 26972, 26975, 26978, 26979, 26980, 26982, 26983, 26984, 26985, 26986, 26987, 26988, 26989, 26998, 26999, 27000, 27001, 27002, 27003, 27004, 27006, 27007, 27008, 27009, 27010, 27011, 27012, 27013, 27014, 27015, 27016, 27017, 27018, 27019, 27031, 27032, 27033, 27039, 27045, 27064, 27067, 27068, 27081, 27091, 27096, 27097, 27098, 27099, 27104, 27106, 27107, 27109, 27123, 27124, 27126, 27130, 27133, 27135, 27140, 27141, 27144, 27145, 27148, 27149, 27152, 27153, 27179, 27184, 27190, 27193, 27197, 27198, 27200, 27203, 27207, 27210, 27211, 27212, 27213, 27214, 27216, 27217, 27218, 27220, 27222, 27223, 27224, 27225, 27226, 27227, 27228, 27230, 27231, 27232, 27233, 27235, 27241, 27243, 27244, 27245, 27246, 27248, 27249, 27253, 27254, 27255, 27259, 27260, 27263, 27264, 27265, 27274, 27279, 27282, 27286, 27296, 27298, 27303, 27306, 27308, 27315, 27316, 27318, 27319, 27324, 27326, 27327, 27329, 27339, 27340, 27350, 27353, 27354, 27355, 27368, 27378, 27379, 27381, 27385, 27386, 27387, 27388, 27389, 27390, 27393, 27394, 27395, 27396, 27397, 27398, 27400, 27403, 27404, 27405, 27407, 27409, 27410, 27411, 27412, 27413, 27414, 27415, 27416, 27417, 27418, 27419, 27420, 27427, 27429, 27431, 27439, 27445, 27455, 27458, 27464, 27474, 27483, 27496, 27497, 27502, 27518, 27519, 27520, 27528, 27544, 27546, 27551, 27553, 27555, 27556, 27582, 27594, 27602, 27605, 27611, 27623, 27627, 27640, 27642, 27643, 27645, 27661, 27674, 27679, 27704, 27709, 27716, 27720, 27723, 27724, 27729, 27737, 27757, 27767, 27768, 27771, 27772, 27779, 27780, 27786, 27789, 27791, 27792, 27793, 27794, 27795, 27796, 27797, 27802, 27805, 27806, 27809, 27815, 27822, 27823, 27824, 27825, 27826, 27828, 27830, 27832, 27835, 27837, 27839, 27851, 27853, 27861, 27875, 27889, 27896, 27898, 27899, 27910, 27911, 27914, 27916, 27934, 27938, 27939, 27942, 27944, 27945, 27947, 27948, 27949, 27950, 27951, 27952, 27953, 27956, 27960, 27963, 27973, 27976, 27979, 27982, 27994, 27995, 27997, 27998, 28000, 28012, 28022, 28027, 28028, 28029, 28030, 28031, 28032, 28033, 28034, 28038, 28039, 28059, 28061, 28072, 28082, 28103, 28107, 28117, 28118, 28119, 28121, 28122, 28124, 28137, 28139, 28141, 28144, 28146, 28148, 28151, 28152, 28169, 28175, 28176, 28179, 28180, 28181, 28185, 28194, 28195, 28196, 28198, 28200, 28201, 28202, 28214, 28216, 28217, 28218, 28227, 28228, 28233, 28234, 28235, 28236, 28242, 28243, 28246, 28250, 28253, 28257, 28258, 28261, 28262, 28266, 28271, 28273, 28283, 28284, 28285, 28286, 28288, 28292, 28314, 28323, 28326, 28341, 28344, 28346, 28350, 28351, 28352, 28353, 28354, 28355, 28357, 28361, 28386, 28388, 28389, 28391, 28392, 28395, 28401, 28403, 28408, 28409, 28413, 28414, 28415, 28417, 28425, 28433, 28437, 28438, 28440, 28455, 28456, 28469, 28479, 28486, 28493, 28494, 28495, 28496, 28497, 28498, 28517, 28538, 28540, 28541, 28542, 28544, 28547, 28548, 28549, 28550, 28551, 28557, 28558, 28559, 28560, 28561, 28563, 28564, 28565, 28566, 28567, 28568, 28569, 28570, 28571, 28572, 28580, 28581, 28603, 28611, 28618, 28620, 28623, 28626, 28627, 28630, 28632, 28635, 28637, 28647, 28648, 28653, 28655, 28656, 28657, 28658, 28661, 28665, 28667, 28686, 28689, 28707, 28708, 28713, 28714, 28716, 28725, 28727, 28732, 28740, 28741, 28742, 28746, 28750, 28753, 28754, 28757, 28758, 28759, 28763, 28776, 28778, 28780, 28781, 28783, 28786, 28787, 28788, 28790, 28791, 28792, 28793, 28795, 28802, 28809, 28821, 28841, 28842, 28846, 28847, 28848, 28849, 28850, 28851, 28855, 28865, 28866, 28867, 28870, 28872, 28874, 28875, 28876, 28877, 28878, 28890, 28891, 28898, 28901, 28912, 28915, 28919, 28921, 28925, 28927, 28928, 28931, 28932, 28935, 28937, 28938, 28939, 28941, 28944, 28947, 28949, 28953, 28955, 28956, 28957, 28960, 28962, 28966, 28968, 28975, 28985, 28986, 28991, 28992, 28993, 29001, 29002, 29003, 29005, 29008, 29010, 29011, 29012, 29013, 29018, 29019, 29027, 29030, 29033, 29036, 29037, 29038, 29039, 29040, 29041, 29042, 29043, 29045, 29048, 29049, 29051, 29053, 29054, 29057, 29058, 29059, 29060, 29061, 29063, 29066, 29068, 29082, 29083, 29092, 29096, 29098, 29099, 29101, 29105, 29112, 29128, 29129, 29130, 29141, 29142, 29143, 29153, 29156, 29159, 29160, 29161, 29162, 29163, 29164, 29168, 29169, 29171, 29176, 29179, 29185, 29188, 29189, 29190, 29191, 29192, 29193, 29196, 29197, 29198, 29201, 29204, 29206, 29207, 29208, 29209, 29210, 29211, 29230, 29231, 29236, 29238, 29241, 29253, 29255, 29256, 29258, 29259, 29263, 29264, 29265, 29267, 29268, 29272, 29276, 29284, 29285, 29286, 29288, 29289, 29291, 29292, 29293, 29296, 29297, 29299, 29302, 29307, 29322, 29340, 29341, 29362, 29363, 29369, 29370, 29372, 29431, 29438, 29440, 29443, 29445, 29446, 29448, 29449, 29455, 29465, 29474, 29476, 29482, 29485, 29498, 29499, 29500, 29501, 29503, 29505, 29519, 29550, 29552, 29554, 29555, 29556, 29557, 29559, 29561, 29568, 29577, 29582, 29598, 29599, 29605, 29611, 29613, 29625, 29631, 29632, 29636, 29637, 29639, 29640, 29650, 29653, 29659, 29664, 29668, 29674, 29681, 29684, 29685, 29696, 29699, 29704, 29705, 29706, 29708, 29709, 29717, 29725, 29736, 29737, 29743, 29744, 29749, 29750, 29753, 29754, 29756, 29757, 29762, 29769, 29773, 29781, 29785, 29786, 29792, 29794, 29795, 29796, 29801, 29807, 29808, 29831, 29837, 29839, 29844, 29847, 29848, 29851, 29852, 29861, 29862, 29869, 29878, 29880, 29881, 29882, 29883, 29884, 29888, 29891, 29895, 29896, 29898, 29915, 29924, 29926, 29930, 29931, 29940, 29947, 29951, 29971, 29972, 29973, 29988, 30000, 30005, 30006, 30040, 30045, 30053, 30058, 30061, 30065, 30067, 30071, 30113, 30131, 30144, 30146, 30147, 30148, 30150, 30178, 30186, 30187, 30193, 30199, 30213, 30252, 30258, 30267, 30279, 30294, 30300, 30301, 30314, 30317, 30326, 30332, 30334, 30340, 30344, 30349, 30354, 30355, 30356, 30372, 30375, 30378, 30400, 30406, 30427, 30433, 30434, 30435, 30436, 30439, 30440, 30446, 30447, 30448, 30449, 30453, 30469, 30470, 30471, 30488, 30494, 30495, 30505, 30513, 30523, 30524, 30525, 30526, 30540, 30541, 30542, 30544, 30547, 30552, 30555, 30562, 30564, 30578, 30584, 30586, 30589, 30590, 30592, 30596, 30597, 30598, 30603, 30625, 30628, 30629, 30630, 30631, 30632, 30634, 30637, 30642, 30644, 30654, 30661, 30664, 30671, 30680, 30693, 30694, 30699, 30704, 30707, 30713, 30717, 30718, 30719, 30721, 30723, 30724, 30729, 30731, 30732, 30734, 30736, 30737, 30740, 30743, 30749, 30751, 30752, 30753, 30764, 30773, 30775, 30782, 30787, 30789, 30792, 30793, 30794, 30795, 30796, 30797, 30798, 30801, 30802, 30803, 30804, 30810, 30818, 30820, 30822, 30823, 30824, 30826, 30827, 30830, 30831, 30834, 30835, 30836, 30837, 30838, 30840, 30843, 30844, 30845, 30847, 30852, 30861, 30862, 30866, 30869, 30870, 30873, 30874, 30875, 30877, 30878, 30895, 30902, 30906, 30907, 30911, 30914, 30917, 30923, 30926, 30929, 30931, 30935, 30938, 30944, 30949, 30950, 30952, 30953, 30970, 30973, 30975, 30977, 30984, 30986, 30992, 30995, 31001, 31003, 31008, 31027, 31029, 31034, 31037, 31084, 31086, 31087, 31096, 31101, 31103, 31106, 31115, 31117, 31118, 31120, 31121, 31122, 31123, 31124, 31125, 31126, 31127, 31129, 31131, 31132, 31134, 31135, 31136, 31139, 31140, 31141, 31142, 31143, 31144, 31145, 31150, 31152, 31153, 31154, 31155, 31158, 31160, 31173, 31178, 31181, 31184, 31185, 31191, 31192, 31193, 31194, 31195, 31197, 31198, 31199, 31200, 31201, 31202, 31207, 31208, 31210, 31211, 31213, 31214, 31215, 31216, 31226, 31227, 31229, 31230, 31232, 31239, 31245, 31248, 31250, 31251, 31254, 31255, 31257, 31260, 31262, 31268, 31269, 31277, 31282, 31283, 31285, 31294, 31299, 31302, 31305, 31306, 31307, 31308, 31312, 31314, 31317, 31320, 31321, 31322, 31325, 31326, 31329, 31330, 31331, 31333, 31337, 31342, 31344, 31345, 31350, 31366, 31373, 31374, 31375, 31377, 31381, 31388, 31404, 31407, 31410, 31411, 31412, 31413, 31415, 31416, 31419, 31421, 31423, 31424, 31427, 31430, 31431, 31433, 31434, 31436, 31437, 31438, 31442, 31443, 31445, 31446, 31447, 31448, 31451, 31453, 31455, 31456, 31457, 31461, 31468, 31469, 31470, 31488, 31527, 31529, 31531, 31534, 31535, 31537, 31538, 31539, 31553, 31554, 31555, 31556, 31557, 31558, 31560, 31561, 31562, 31563, 31565, 31575, 31576, 31580, 31581, 31583, 31584, 31585, 31586, 31587, 31588, 31589, 31598, 31599, 31600, 31604, 31605, 31607, 31608, 31611, 31616, 31617, 31620, 31623, 31629, 31631, 31633, 31635, 31637, 31638, 31639, 31640, 31641, 31643, 31644, 31645, 31647, 31650, 31652, 31653, 31659, 31660, 31663, 31667, 31668, 31676, 31678, 31679, 31680, 31683, 31687, 31689, 31690, 31691, 31692, 31696, 31702, 31703, 31707, 31714, 31716, 31718, 31727, 31736, 31737, 31738, 31742, 31746, 31748, 31750, 31753, 31754, 31755, 31757, 31759, 31760, 31761, 31762, 31764, 31766, 31768, 31769, 31770, 31771, 31773, 31775, 31783, 31793, 31796, 31799, 31804, 31813, 31818, 31823, 31830, 31833, 31835, 31836, 31838, 31839, 31845, 31846, 31847, 31848, 31849, 31850, 31859, 31861, 31863, 31865, 31866, 31867, 31868, 31869, 31870, 31872, 31876, 31879, 31880, 31886, 31889, 31890, 31891, 31893, 31894, 31895, 31897, 31899, 31900, 31902, 31903, 31905, 31906, 31907, 31909, 31912, 31922, 31923, 31924, 31928, 31933, 31935, 31948, 31949, 31950, 31951, 31963, 31965, 31967, 31972, 31979, 31985, 31987, 31988, 31998, 31999, 32000, 32009, 32016, 32021, 32022, 32023, 32024, 32025, 32026, 32027, 32029, 32039, 32041, 32042, 32044, 32045, 32048, 32049, 32050, 32058, 32061, 32064, 32065, 32066, 32067, 32071, 32072, 32073, 32074, 32075, 32077, 32078, 32079, 32080, 32081, 32084, 32085, 32086, 32087, 32089, 32094, 32104, 32110, 32111, 32112, 32113, 32114, 32115, 32116, 32118, 32119, 32121, 32122, 32123, 32125, 32130, 32131, 32139, 32141, 32142, 32143, 32145, 32148, 32152, 32153, 32155, 32161, 32162, 32164, 32168, 32175, 32176, 32181, 32183, 32184, 32197, 32200, 32203, 32205, 32206, 32207, 32212, 32214, 32215, 32228, 32234, 32237, 32238, 32239, 32242, 32243, 32248, 32258, 32260, 32265, 32266, 32275, 32276, 32279, 32280, 32282, 32283, 32293, 32300, 32320, 32323, 32329, 32336, 32337, 32338, 32339, 32340, 32341, 32342, 32343, 32345, 32346, 32368, 32369, 32374, 32396, 32416, 32431, 32433, 32434, 32448, 32452, 32455, 32460, 32461, 32462, 32463, 32472, 32473, 32477, 32480, 32481, 32485, 32486, 32487, 32489, 32490, 32492, 32510, 32512, 32517, 32522, 32527, 32528, 32534, 32545, 32548, 32550, 32552, 32554, 32555, 32582, 32601, 32602, 32603, 32604, 32605, 32608, 32612, 32631, 32634, 32645, 32653, 32659, 32661, 32662, 32663, 32668, 32686, 32698, 32699, 32701, 32702, 32703, 32705, 32710, 32721, 32722, 32723, 32725, 32727, 32732, 32733, 32736, 32742, 32746, 32776, 32780, 32782, 32783, 32784, 32786, 32792, 32793, 32795, 32796, 32797, 32802, 32810, 32812, 32813, 32819, 32826, 32827, 32830, 32832, 32834, 32837, 32838, 32840, 32846, 32866, 32867, 32868, 32869, 32870, 32871, 32873, 32882, 32884, 32885, 32886, 32898, 32899, 32901, 32902, 32905, 32910, 32911, 32917, 32918, 32920, 32923, 32937, 32940, 32942, 32947, 32963, 32973, 32986, 32987, 32990, 32994, 33030, 33041, 33052, 33054, 33066, 33069, 33072, 33075, 33076, 33082, 33086, 33088, 33090, 33091, 33096, 33108, 33113, 33116, 33120, 33121, 33122, 33123, 33124, 33125, 33126, 33127, 33129, 33131, 33132, 33133, 33135, 33136, 33137, 33138, 33139, 33144, 33149, 33154, 33158, 33203, 33204, 33209, 33210, 33211, 33225, 33230, 33233, 33236, 33239, 33242, 33243, 33250, 33254, 33258, 33259, 33263, 33265, 33281, 33286, 33287, 33294, 33300, 33312, 33313, 33315, 33316, 33318, 33322, 33323, 33324, 33325, 33326, 33327, 33328, 33331, 33333, 33340, 33353, 33354, 33355, 33356, 33366, 33369, 33388, 33391, 33392, 33393, 33395, 33396, 33401, 33402, 33408, 33409, 33410, 33414, 33415, 33417, 33420, 33424, 33427, 33431, 33432, 33439, 33443, 33448, 33451, 33456, 33462, 33463, 33469, 33471, 33476, 33477, 33481, 33483, 33489, 33492, 33493, 33500, 33503, 33504, 33508, 33511, 33514, 33516, 33519, 33526, 33527, 33528, 33530, 33532, 33533, 33536, 33537, 33538, 33539, 33540, 33541, 33543, 33544, 33546, 33547, 33548, 33549, 33560, 33562, 33564, 33565, 33577, 33578, 33580, 33582, 33583, 33584, 33588, 33591, 33592, 33593, 33599, 33604, 33607, 33608, 33609, 33613, 33614, 33623, 33624, 33625, 33629, 33640, 33641, 33643, 33644, 33645, 33647, 33658, 33659, 33660, 33662, 33665, 33666, 33671, 33672, 33674, 33676, 33678, 33679, 33680, 33682, 33683, 33685, 33687, 33691, 33692, 33695, 33696, 33699, 33702, 33703, 33705, 33708, 33711, 33712, 33715, 33716, 33717, 33718, 33719, 33720, 33724, 33725, 33726, 33730, 33733, 33739, 33752, 33753, 33754, 33757, 33758, 33759, 33760, 33781, 33785, 33787, 33788, 33789, 33791, 33798, 33804, 33822, 33826, 33829, 33830, 33840, 33841, 33849, 33865, 33867, 33873, 33874, 33875, 33876, 33877, 33878, 33886, 33889, 33890, 33893, 33894, 33895, 33896, 33897, 33898, 33900, 33901, 33902, 33903, 33904, 33905, 33918, 33919, 33925, 33927, 33929, 33931, 33934, 33935, 33942, 33943, 33944, 33949, 33964, 33967, 33973, 33975, 33976, 33986, 34011, 34014, 34015, 34016, 34018, 34019, 34020, 34021, 34022, 34023, 34025, 34026, 34030, 34031, 34033, 34036, 34037, 34039, 34045, 34047, 34048, 34049, 34051, 34054, 34056, 34057, 34058, 34059, 34061, 34062, 34063, 34065, 34066, 34067, 34068, 34070, 34073, 34075, 34077, 34078, 34082, 34085, 34086, 34106, 34112, 34114, 34115, 34116, 34117, 34121, 34124, 34125, 34129, 34130, 34131, 34132, 34139, 34146, 34147, 34150, 34151, 34155, 34173, 34176, 34180, 34182, 34183, 34184, 34185, 34189, 34192, 34194, 34198, 34199, 34200, 34201, 34204, 34205, 34206, 34207, 34208, 34210, 34211, 34213, 34215, 34216, 34218, 34220, 34221, 34224, 34225, 34226, 34236, 34239, 34245, 34249, 34255, 34256, 34261, 34266, 34282, 34286, 34287, 34290, 34293, 34297, 34300, 34305, 34315, 34323, 34326, 34327, 34329, 34330, 34337, 34344, 34345, 34349, 34353, 34355, 34358, 34372, 34374, 34389, 34391, 34405, 34406, 34409, 34410, 34413, 34415, 34416, 34418, 34419, 34422, 34424, 34425, 34448, 34452, 34467, 34469, 34479, 34481, 34482, 34483, 34489, 34492, 34495, 34496, 34507, 34510, 34521, 34526, 34533, 34535, 34536, 34542, 34545, 34546, 34549, 34553, 34555, 34557, 34559, 34560, 34561, 34564, 34565, 34568, 34570, 34571, 34578, 34582, 34585, 34588, 34589, 34591, 34595, 34606, 34607, 34608, 34609, 34610, 34611, 34613, 34614, 34615, 34616, 34631, 34633, 34640, 34642, 34649, 34650, 34651, 34652, 34655, 34663, 34665, 34666, 34667, 34669, 34670, 34675, 34678, 34688, 34689, 34690, 34691, 34693, 34695, 34696, 34697, 34699, 34700, 34703, 34705, 34707, 34709, 34711, 34712, 34713, 34714, 34715, 34718, 34728, 34733, 34736, 34743, 34746, 34747, 34748, 34749, 34759, 34761, 34763, 34764, 34765, 34766, 34767, 34769, 34771, 34773, 34774, 34775, 34778, 34788, 34811, 34823, 34824, 34830, 34839, 34853, 34858, 34863, 34868, 34869, 34883, 34906, 34908, 34940, 34945, 34951, 34966, 34967, 34970, 34974, 34977, 34978, 35009, 35013, 35029, 35035, 35037, 35038, 35058, 35063, 35065, 35080, 35082, 35090, 35092, 35093, 35094, 35095, 35106, 35107, 35112, 35114, 35119, 35127, 35130, 35156, 35157, 35160, 35171, 35174, 35176, 35178, 35180, 35181, 35185, 35186, 35187, 35188, 35190, 35193, 35197, 35198, 35218, 35222, 35223, 35224, 35235, 35238, 35239, 35240, 35241, 35242, 35243, 35244, 35245, 35248, 35249, 35250, 35252, 35254, 35265, 35268, 35270, 35273, 35282, 35285, 35289, 35303, 35304, 35305, 35331, 35335, 35337, 35339, 35342, 35351, 35358, 35360, 35363, 35372, 35376, 35379, 35382, 35396, 35399, 35400, 35401, 35413, 35434, 35437, 35442, 35446, 35448, 35450, 35452, 35454, 35461, 35466, 35467, 35473, 35479, 35480, 35481, 35483, 35484, 35485, 35487, 35492, 35493, 35494, 35503, 35504, 35505, 35506, 35518, 35523, 35526, 35529, 35530, 35532, 35533, 35536, 35537, 35538, 35539, 35540, 35542, 35543, 35545, 35546, 35549, 35550, 35551, 35552, 35558, 35559, 35561, 35564, 35565, 35566, 35567, 35571, 35572, 35574, 35584, 35586, 35588, 35590, 35591, 35592, 35593, 35603, 35612, 35623, 35647, 35649, 35655, 35657, 35660, 35663, 35665, 35669, 35672, 35673, 35675, 35679, 35680, 35682, 35691, 35695, 35710, 35715, 35717, 35718, 35719, 35721, 35724, 35731, 35744, 35751, 35754, 35756, 35761, 35762, 35763, 35764, 35766, 35771, 35777, 35778, 35779, 35782, 35789, 35790, 35792, 35793, 35798, 35803, 35805, 35806, 35818, 35819, 35820, 35821, 35822, 35824, 35825, 35826, 35827, 35828, 35829, 35830, 35832, 35833, 35834, 35836, 35837, 35847, 35851, 35859, 35861, 35874, 35879, 35887, 35889, 35890, 35891, 35892, 35893, 35895, 35896, 35907, 35908, 35909, 35914, 35917, 35919, 35921, 35922, 35923, 35938, 35941, 35943, 35944, 35945, 35946, 35948, 35950, 35952, 35953, 35970, 35979, 35980, 35985, 35987, 35988, 35997, 35998, 36001, 36002, 36004, 36005, 36015, 36017, 36021, 36049, 36057, 36071, 36076, 36079, 36092, 36095, 36111, 36120, 36121, 36122, 36128, 36129, 36130, 36131, 36140, 36156, 36162, 36163, 36164, 36165, 36166, 36168, 36170, 36171, 36173, 36174, 36177, 36178, 36179, 36181, 36182, 36183, 36184, 36187, 36189, 36190, 36192, 36193, 36194, 36195, 36196, 36198, 36203, 36208, 36210, 36212, 36213, 36220, 36224, 36229, 36238, 36241, 36242, 36244, 36248, 36250, 36251, 36273, 36275, 36282, 36283, 36291, 36299, 36304, 36305, 36308, 36311, 36312, 36313, 36314, 36315, 36317, 36319, 36320, 36321, 36322, 36323, 36325, 36329, 36333, 36335, 36336, 36337, 36342, 36343, 36344, 36345, 36346, 36349, 36354, 36361, 36362, 36366, 36371, 36386, 36387, 36404, 36407, 36412, 36414, 36422, 36424, 36431, 36434, 36437, 36438, 36440, 36444, 36449, 36450, 36452, 36467, 36468, 36469, 36470, 36471, 36474, 36475, 36477, 36479, 36486, 36487, 36491, 36494, 36505, 36506, 36508, 36512, 36524, 36526, 36527, 36528, 36529, 36541, 36543, 36546, 36554, 36555, 36556, 36558, 36570, 36571, 36577, 36584, 36593, 36596, 36613, 36615, 36616, 36618, 36629, 36630, 36632, 36636, 36640, 36664, 36665, 36667, 36668, 36669, 36693, 36704, 36706, 36710, 36713, 36714, 36715, 36724, 36735, 36739, 36742, 36743, 36744, 36750, 36751, 36753, 36760, 36761, 36762, 36764, 36765, 36766, 36769, 36771, 36778, 36780, 36781, 36782, 36787, 36789, 36790, 36793, 36795, 36797, 36798, 36799, 36800, 36801, 36810, 36814, 36820, 36821, 36835, 36838, 36842, 36858, 36871, 36872, 36891, 36905, 36922, 36958, 36960, 36965, 36973, 36974, 36975, 36976, 36981, 36982, 36990, 36991, 37033, 37035, 37036, 37037, 37039, 37040, 37041, 37045, 37046, 37049, 37050, 37086, 37096, 37107, 37110, 37114, 37115, 37116, 37119, 37120, 37142, 37143, 37146, 37151, 37153, 37154, 37157, 37159, 37161, 37162, 37163, 37164, 37165, 37166, 37167, 37168, 37170, 37171, 37172, 37174, 37175, 37176, 37178, 37179, 37181, 37183, 37195, 37196, 37213, 37220, 37224, 37225, 37227, 37236, 37251, 37257, 37258, 37260, 37264, 37269, 37270, 37275, 37277, 37279, 37297, 37299, 37303, 37304, 37312, 37313, 37326, 37354, 37367, 37368, 37376, 37382, 37383, 37384, 37402, 37433, 37451, 37471, 37476, 37477, 37482, 37483, 37486, 37487, 37499, 37503, 37504, 37505, 37506, 37507, 37508, 37519, 37520, 37521, 37522, 37523, 37524, 37527, 37534, 37549, 37552, 37564, 37572, 37573, 37591, 37612, 37624, 37634, 37635, 37636, 37638, 37639, 37641, 37642, 37643, 37646, 37660, 37662, 37664, 37668, 37673, 37674, 37675, 37676, 37677, 37679, 37682, 37684, 37685, 37696, 37697, 37698, 37699, 37700, 37701, 37702, 37706, 37711, 37713, 37726, 37739, 37741, 37749, 37750, 37754, 37761, 37762, 37766, 37778, 37779, 37781, 37782, 37799, 37809, 37810, 37814, 37822, 37825, 37840, 37848, 37851, 37857, 37859, 37860, 37861, 37863, 37867, 37871, 37873, 37877, 37887, 37901, 37913, 37914, 37926, 37928, 37939, 37940, 37941, 37945, 37947, 37948, 37950, 37951, 37954, 37957, 37958, 37959, 37960, 37962, 37995, 37998, 38003, 38004, 38005, 38006, 38007, 38009, 38022, 38027, 38034, 38035, 38036, 38039, 38040, 38041, 38043, 38047, 38048, 38050, 38051, 38053, 38054, 38068, 38069, 38077, 38078, 38079, 38081, 38082, 38083, 38084, 38085, 38086, 38092, 38093, 38099, 38100, 38103, 38104, 38106, 38107, 38108, 38118, 38123, 38124, 38128, 38129, 38130, 38131, 38134, 38140, 38143, 38148, 38150, 38154, 38155, 38156, 38157, 38158, 38159, 38160, 38165, 38176, 38179, 38180, 38182, 38183, 38186, 38190, 38191, 38192, 38206, 38209, 38211, 38231, 38232, 38233, 38235, 38236, 38244, 38246, 38255, 38257, 38269, 38284, 38289, 38290, 38291, 38300, 38301, 38308, 38310, 38312, 38315, 38316, 38317, 38319, 38320, 38321, 38322, 38323, 38324, 38328, 38329, 38335, 38336, 38346, 38348, 38349, 38350, 38353, 38355, 38372, 38388, 38394, 38398, 38401, 38413, 38417, 38419, 38420, 38421, 38422, 38423, 38424, 38425, 38427, 38428, 38429, 38430, 38434, 38438, 38441, 38442, 38444, 38461, 38462, 38463, 38464, 38479, 38480, 38495, 38497, 38504, 38505, 38506, 38507, 38510, 38511, 38520, 38523, 38524, 38525, 38526, 38527, 38528, 38529, 38530, 38531, 38532, 38535, 38536, 38537, 38540, 38541, 38543, 38544, 38545, 38547, 38549, 38550, 38551, 38552, 38558, 38566, 38570, 38576, 38577, 38590, 38592, 38593, 38594, 38595, 38596, 38597, 38602, 38611, 38615, 38621, 38623, 38627, 38628, 38629, 38630, 38631, 38632, 38633, 38634, 38636, 38637, 38657, 38665, 38671, 38672, 38673, 38674, 38676, 38682, 38696, 38697, 38701, 38724, 38726, 38733, 38734, 38740, 38742, 38745, 38749, 38754, 38755, 38756, 38757, 38766, 38767, 38769, 38774, 38780, 38790, 38795, 38811, 38814, 38817, 38818, 38820, 38824, 38825, 38826, 38836, 38844, 38870, 38876, 38878, 38879, 38880, 38902, 38905, 38920, 38922, 38941, 38943, 38946, 38957, 38958, 38960, 38964, 38965, 38966, 38971, 38993, 39003, 39006, 39015, 39016, 39021, 39026, 39040, 39045, 39049, 39052, 39060, 39061, 39062, 39077, 39079, 39087, 39088, 39095, 39102, 39103, 39104, 39105, 39106, 39107, 39111, 39114, 39115, 39127, 39129, 39132, 39133, 39134, 39135, 39136, 39137, 39139, 39140, 39141, 39147, 39148, 39155, 39156, 39160, 39167, 39170, 39172, 39175, 39176, 39177, 39183, 39184, 39200, 39219, 39220, 39225, 39226, 39230, 39246, 39247, 39250, 39251, 39252, 39257, 39259, 39266, 39267, 39269, 39277, 39288, 39295, 39311, 39322, 39324, 39325, 39332, 39335, 39336, 39338, 39339, 39355, 39357, 39358, 39361, 39364, 39365, 39372, 39386, 39392, 39393, 39399, 39403, 39404, 39405, 39406, 39408, 39411, 39417, 39421, 39424, 39428, 39429, 39430, 39431, 39438, 39440, 39444, 39449, 39461, 39462, 39463, 39464, 39465, 39466, 39467, 39472, 39479, 39491, 39497, 39499, 39502, 39504, 39505, 39506, 39508, 39509, 39511, 39512, 39515, 39516, 39517, 39518, 39520, 39521, 39522, 39523, 39524, 39525, 39526, 39528, 39529, 39537, 39538, 39542, 39545, 39547, 39548, 39550, 39556, 39557, 39559, 39561, 39565, 39568, 39570, 39571, 39574, 39575, 39579, 39603, 39625, 39631, 39632, 39637, 39640, 39641, 39647, 39659, 39662, 39663, 39664, 39666, 39667, 39668, 39669, 39670, 39671, 39672, 39673, 39674, 39675, 39676, 39677, 39678, 39679, 39683, 39695, 39696, 39697, 39698, 39699, 39702, 39704, 39705, 39706, 39707, 39708, 39709, 39717, 39719, 39720, 39721, 39722, 39723, 39726, 39727, 39734, 39737, 39744, 39749, 39752, 39754, 39768, 39769, 39770, 39775, 39776, 39777, 39778, 39787, 39788, 39789, 39792, 39794, 39795, 39796, 39797, 39809, 39810, 39812, 39814, 39815, 39818, 39820, 39821, 39823, 39824, 39825, 39832, 39838, 39840, 39841, 39842, 39864, 39867, 39875, 39877, 39881, 39882, 39883, 39884, 39885, 39905, 39917, 39918, 39919, 39926, 39931, 39936, 39937, 39938, 39939, 39940, 39941, 39949, 39950, 39951, 39952, 39953, 39954, 39955, 39956, 39957, 39958, 39969, 39970, 39971, 39972, 39973, 39976, 39977, 39981, 39982, 39985, 39986, 39987, 39988, 39989, 39990, 39992, 39999, 40001, 40006, 40007, 40014, 40020, 40023, 40027, 40028, 40040, 40042, 40044, 40045, 40046, 40049, 40052, 40054, 40055, 40057, 40060, 40061, 40062, 40063, 40066, 40075, 40076, 40077, 40078, 40079, 40080, 40081, 40085, 40100, 40102, 40103, 40105, 40106, 40107, 40109, 40112, 40114, 40115, 40118, 40120, 40121, 40122, 40127, 40128, 40137, 40140, 40141, 40142, 40148, 40149, 40150, 40151, 40152, 40163, 40168, 40179, 40183, 40187, 40189, 40196, 40197, 40198, 40199, 40203, 40209, 40214, 40220, 40221, 40225, 40228, 40229, 40230, 40231, 40246, 40253, 40254, 40258, 40259, 40260, 40274, 40281, 40284, 40285, 40286, 40287, 40291, 40292, 40294, 40295, 40296, 40298, 40299, 40300, 40305, 40308, 40309, 40310, 40312, 40313, 40314, 40316, 40322, 40323, 40325, 40327, 40332, 40333, 40334, 40335, 40342, 40343, 40348, 40350, 40351, 40359, 40360, 40362, 40363, 40369, 40370, 40371, 40373, 40378, 40379, 40383, 40384, 40387, 40388, 40395, 40396, 40397, 40399, 40400, 40401, 40402, 40403, 40404, 40406, 40411, 40413, 40415, 40416, 40418, 40427, 40436, 40456, 40459, 40467, 40468, 40469, 40470, 40471, 40472, 40473, 40474, 40483, 40484, 40496, 40501, 40502, 40503, 40505, 40509, 40510, 40513, 40515, 40516, 40517, 40521, 40528, 40535, 40543, 40544, 40546, 40548, 40550, 40556, 40562, 40569, 40577, 40578, 40581, 40582, 40583, 40584, 40586, 40587, 40588, 40591, 40593, 40595, 40598, 40599, 40601, 40606, 40611, 40628, 40629, 40641, 40646, 40656, 40657, 40658, 40660, 40661, 40662, 40663, 40691, 40692, 40695, 40698, 40704, 40709, 40712, 40713, 40714, 40729, 40730, 40731, 40734, 40738, 40745, 40746, 40749, 40750, 40751, 40752, 40754, 40755, 40757, 40759, 40761, 40763, 40764, 40785, 40786, 40788, 40791, 40793, 40794, 40796, 40797, 40798, 40800, 40801, 40803, 40805, 40806, 40807, 40808, 40811, 40813, 40821, 40830, 40831, 40832, 40834, 40836, 40839, 40840, 40841, 40842, 40844, 40845, 40846, 40847, 40848, 40850, 40851, 40852, 40854, 40857, 40859, 40860, 40875, 40879, 40884, 40885, 40888, 40897, 40901, 40902, 40903, 40904, 40905, 40906, 40907, 40912, 40920, 40936, 40941, 40964, 40971, 40976, 40978, 40979, 40982, 40988, 40989, 40993, 40994, 41005, 41007, 41008, 41019, 41021, 41022, 41036, 41037, 41039, 41042, 41043, 41045, 41054, 41071, 41075, 41076, 41078, 41086, 41090, 41094, 41095, 41112, 41113, 41121, 41124, 41128, 41129, 41140, 41150, 41153, 41154, 41156, 41157, 41158, 41160, 41163, 41164, 41165, 41166, 41167, 41168, 41176, 41178, 41179, 41180, 41182, 41185, 41193, 41195, 41206, 41212, 41213, 41247, 41248, 41249, 41253, 41254, 41257, 41259, 41261, 41265, 41266, 41267, 41269, 41271, 41272, 41273, 41275, 41276, 41280, 41281, 41282, 41284, 41285, 41289, 41290, 41291, 41294, 41296, 41315, 41317, 41320, 41321, 41324, 41335, 41337, 41340, 41348, 41350, 41360, 41369, 41370, 41371, 41372, 41373, 41375, 41381, 41382, 41387, 41388, 41392, 41394, 41395, 41399, 41401, 41402, 41420, 41421, 41423, 41424, 41438, 41444, 41446, 41449, 41451, 41473, 41482, 41498, 41509, 41511, 41513, 41518, 41521, 41523, 41537, 41545, 41547, 41552, 41553, 41554, 41556, 41557, 41568, 41571, 41582, 41590, 41591, 41601, 41604, 41605, 41610, 41613, 41614, 41615, 41616, 41618, 41620, 41621, 41628, 41655, 41656, 41657, 41658, 41667, 41673, 41675, 41676, 41677, 41678, 41681, 41683, 41689, 41690, 41698, 41699, 41708, 41711, 41716, 41718, 41719, 41721, 41722, 41723, 41724, 41725, 41749, 41750, 41788, 41789, 41793, 41794, 41795, 41797, 41798, 41801, 41803, 41804, 41845, 41846, 41850, 41852, 41853, 41855, 41856, 41857, 41858, 41871, 41873, 41874, 41875, 41876, 41878, 41880, 41889, 41890, 41895, 41907, 41912, 41913, 41922, 41923, 41939, 41940, 41943, 41949, 41969, 41976, 41977, 41978, 41979, 41980, 41986, 41987, 41993, 41995, 42040, 42067, 42083, 42100, 42101, 42102, 42103, 42104, 42105, 42106, 42107, 42108, 42109, 42110, 42111, 42112, 42113, 42114, 42115, 42116, 42117, 42118, 42120, 42122, 42127, 42131, 42135, 42136, 42140, 42141, 42143, 42144, 42145, 42146, 42147, 42148, 42150, 42152, 42157, 42158, 42162, 42164, 42170, 42175, 42181, 42182, 42187, 42188, 42190, 42193, 42194, 42195, 42236, 42237, 42238, 42259, 42269, 42270, 42271, 42272, 42273, 42274, 42275, 42277, 42280, 42284, 42285, 42289, 42297, 42298, 42302, 42303, 42304, 42306, 42309, 42310, 42311, 42313, 42315, 42317, 42336, 42337, 42342, 42351, 42352, 42356, 42368, 42370, 42371, 42373, 42374, 42383, 42384, 42385, 42386, 42387, 42388, 42389, 42390, 42394, 42395, 42396, 42397, 42398, 42399, 42400, 42401, 42402, 42431, 42435, 42436, 42440, 42443, 42444, 42449, 42450, 42451, 42453, 42457, 42458, 42459, 42460, 42461, 42462, 42463, 42468, 42512, 42513, 42514, 42518, 42520, 42525, 42528, 42529, 42535, 42538, 42540, 42581, 42582, 42592, 42600, 42635, 42641, 42647, 42650, 42668, 42670, 42672, 42674, 42676, 42677, 42681, 42727, 42728, 42759, 42827, 42828, 42832, 42835, 42836, 42845, 42846, 42847, 42878, 42879, 42885, 42887, 42888, 42889, 42890, 42891, 42894, 42916, 42918, 42948, 42950, 42951, 42952, 42953, 42954, 42955, 42956, 42957, 42961, 42962, 42963, 42965, 42966, 42967, 42971, 42982, 42985, 42996, 42997, 43009, 43011, 43012, 43036, 43038, 43046, 43048, 43049, 43051, 43054, 43055, 43057, 43058, 43064, 43065, 43076, 43081, 43087, 43088, 43089, 43093, 43094, 43095, 43096, 43097, 43098, 43112, 43113, 43116, 43118, 43123, 43124, 43125, 43150, 43151, 43166, 43167, 43169, 43174, 43176, 43185, 43186, 43203, 43225, 43228, 43247, 43249, 43251, 43262, 43272, 43276, 43279, 43281, 43302, 43303, 43306, 43330, 43331, 43332, 43344, 43345, 43354, 43355, 43364, 43380, 43383, 43384, 43385, 43391, 43393, 43394, 43395, 43396, 43397, 43398, 43399, 43406, 43409, 43411, 43417, 43418, 43419, 43420, 43421, 43424, 43425, 43426, 43427, 43432, 43434, 43465, 43466, 43467, 43470, 43471, 43473, 43476, 43479, 43480, 43481, 43484, 43485, 43489, 43490, 43491, 43493, 43494, 43495, 43499, 43500, 43503, 43504, 43507, 43510, 43511, 43512, 43515, 43517, 43523, 43524, 43526, 43541, 43546, 43548, 43549, 43551, 43553, 43554, 43555, 43558, 43567, 43569, 43573, 43574, 43575, 43576, 43604, 43608, 43609, 43615, 43616, 43622, 43628, 43630, 43634, 43635, 43636, 43647, 43649, 43665, 43666, 43667, 43672, 43673, 43674, 43676, 43677, 43678, 43679, 43681, 43706, 43713, 43714, 43721, 43751, 43752, 43764, 43774, 43775, 43785, 43791, 43792, 43795, 43796, 43797, 43798, 43799, 43800, 43801, 43803, 43806, 43820, 43827, 43828, 43832, 43833, 43840, 43841, 43850, 43854, 43857, 43859, 43861, 43865, 43868, 43890, 43893, 43895, 43896, 43898, 43903, 43904, 43906, 43909, 43913, 43915, 43919, 43921, 43923, 43926, 43927, 43928, 43932, 43943, 43944, 43948, 43949, 43950, 43960, 43962, 43963, 43964, 43965, 43998, 43999, 44000, 44001, 44002, 44006, 44011, 44012, 44013, 44015, 44019, 44022, 44029, 44037, 44039, 44040, 44042, 44050, 44057, 44066, 44070, 44075, 44083, 44084, 44085, 44086, 44087, 44088, 44095, 44096, 44099, 44100, 44101, 44102, 44104, 44105, 44106, 44107, 44108, 44110, 44119, 44127, 44130, 44131, 44132, 44137, 44152, 44154, 44159, 44161, 44163, 44167, 44169, 44171, 44175, 44190, 44194, 44204, 44219, 44222, 44223, 44224, 44226, 44230, 44236, 44240, 44249, 44251, 44254, 44255, 44257, 44258, 44259, 44260, 44261, 44263, 44267, 44268, 44272, 44276, 44277, 44278, 44280, 44281, 44282, 44283, 44284, 44289, 44294, 44295, 44309, 44315, 44316, 44323, 44324, 44325, 44326, 44328, 44329, 44334, 44338, 44341, 44343, 44345, 44346, 44358, 44364, 44380, 44381, 44400, 44410, 44415, 44417, 44418, 44420, 44422, 44424, 44433, 44444, 44449, 44450, 44451, 44453, 44454, 44455, 44463, 44470, 44476, 44477, 44479, 44480, 44486, 44498, 44501, 44502, 44503, 44505, 44506, 44507, 44509, 44512, 44513, 44516, 44518, 44520, 44524, 44525, 44528, 44530, 44539, 44542, 44544, 44545, 44546, 44547, 44550, 44553, 44565, 44570, 44571, 44573, 44576, 44580, 44587, 44588, 44589, 44594, 44597, 44602, 44603, 44604, 44606, 44607, 44608, 44611, 44612, 44615, 44617, 44618, 44620, 44626, 44627, 44628, 44629, 44631, 44632, 44633, 44635, 44636, 44638, 44639, 44642, 44645, 44646, 44648, 44653, 44654, 44657, 44663, 44668, 44672, 44673, 44674, 44675, 44678, 44680, 44683, 44688, 44691, 44693, 44694, 44699, 44700, 44702, 44710, 44711, 44712, 44713, 44715, 44716, 44717, 44718, 44719, 44721, 44722, 44723, 44724, 44725, 44726, 44727, 44728, 44739, 44742, 44743, 44744, 44755, 44758, 44763, 44765, 44769, 44770, 44772, 44776, 44777, 44778, 44779, 44782, 44787, 44790, 44791, 44794, 44795, 44799, 44809, 44814, 44815, 44816, 44826, 44827, 44828, 44830, 44831, 44837, 44839, 44841, 44846, 44848, 44854, 44855, 44856, 44857, 44858, 44863, 44872, 44875, 44879, 44881, 44886, 44899, 44904, 44914, 44916, 44923, 44927, 44928, 44931, 44939, 44941, 44942, 44943, 44945, 44946, 44955, 44956, 44961, 44962, 44965, 44972, 44992, 44993, 44996, 44997, 44998, 45000, 45001, 45002, 45003, 45004, 45005, 45006, 45007, 45017, 45018, 45025, 45026, 45027, 45028, 45031, 45039, 45047, 45076, 45085, 45094, 45098, 45106, 45108, 45109, 45118, 45120, 45146, 45149, 45151, 45152, 45153, 45154, 45155, 45157, 45158, 45159, 45160, 45163, 45164, 45166, 45168, 45169, 45171, 45173, 45174, 45180, 45208, 45209, 45215, 45227, 45232, 45233, 45234, 45239, 45241, 45242, 45244, 45245, 45249, 45250, 45251, 45252, 45253, 45254, 45257, 45258, 45259, 45260, 45270, 45271, 45272, 45275, 45276, 45277, 45280, 45281, 45282, 45283, 45284, 45285, 45286, 45294, 45300, 45301, 45302, 45304, 45305, 45306, 45309, 45310, 45311, 45312, 45318, 45319, 45320, 45322, 45323, 45325, 45326, 45327, 45330, 45335, 45340, 45342, 45343, 45344, 45347, 45348, 45350, 45351, 45353, 45354, 45357, 45366, 45367, 45368, 45373, 45382, 45383, 45389, 45393, 45394, 45400, 45402, 45404, 45406, 45412, 45414, 45415, 45426, 45434, 45442, 45444, 45445, 45448, 45449, 45452, 45460, 45463, 45464, 45465, 45466, 45467, 45469, 45471, 45473, 45475, 45476, 45494, 45499, 45501, 45507, 45509, 45510, 45511, 45512, 45514, 45515, 45516, 45517, 45518, 45519, 45527, 45529, 45530, 45540, 45541, 45544, 45545, 45546, 45547, 45549, 45550, 45552, 45554, 45555, 45556, 45564, 45565, 45566, 45567, 45568, 45569, 45570, 45575, 45578, 45579, 45580, 45582, 45583, 45591, 45599, 45606, 45607, 45608, 45610, 45611, 45612, 45615, 45617, 45620, 45628, 45635, 45637, 45643, 45648, 45649, 45650, 45651, 45652, 45656, 45657, 45659, 45661, 45662, 45664, 45676, 45678, 45680, 45684, 45686, 45695, 45702, 45711, 45730, 45734, 45737, 45738, 45739, 45740, 45741, 45742, 45743, 45745, 45746, 45747, 45748, 45749, 45750, 45751, 45752, 45753, 45754, 45755, 45759, 45768, 45770, 45780, 45783, 45785, 45786, 45787, 45791, 45797, 45799, 45800, 45802, 45824, 45825, 45829, 45830, 45831, 45832, 45840, 45852, 45873, 45875, 45876, 45894, 45910, 45915, 45916, 45917, 45918, 45919, 45920, 45921, 45922, 45924, 45925, 45926, 45931, 45932, 45934, 45939, 45940, 45941, 45942, 45944, 45945, 45946, 45947, 45948, 45974, 45975, 45981, 45984, 45986, 46006, 46007, 46024, 46026, 46031, 46032, 46059, 46068, 46070, 46083, 46091, 46092, 46101, 46102, 46103, 46104, 46105, 46113, 46114, 46126, 46127, 46128, 46134, 46140, 46145, 46147, 46150, 46152, 46155, 46157, 46166, 46169, 46175, 46187, 46188, 46191, 46193, 46198, 46202, 46208, 46212, 46214, 46217, 46219, 46220, 46232, 46233, 46234, 46235, 46239, 46243, 46244, 46245, 46249, 46251, 46252, 46254, 46261, 46263, 46264, 46265, 46266, 46267, 46268, 46270, 46282, 46283, 46284, 46285, 46286, 46288, 46289, 46290, 46302, 46303, 46310, 46313, 46314, 46327, 46331, 46332, 46333, 46343, 46349, 46351, 46358, 46363, 46364, 46366, 46372, 46374, 46378, 46379, 46381, 46382, 46383, 46384, 46385, 46389, 46390, 46394, 46404, 46405, 46407, 46408, 46415, 46417, 46423, 46430, 46437, 46441, 46448, 46466, 46467, 46472, 46474, 46476, 46515, 46518, 46524, 46529, 46533, 46536, 46539, 46541, 46545, 46546, 46562, 46578, 46580, 46588, 46591, 46595, 46596, 46600, 46607, 46611, 46614, 46618, 46620, 46625, 46626, 46627, 46629, 46632, 46636, 46652, 46653, 46654, 46655, 46656, 46657, 46658, 46662, 46663, 46664, 46667, 46670, 46671, 46672, 46673, 46674, 46683, 46684, 46685, 46687, 46691, 46692, 46694, 46699, 46711, 46713, 46716, 46733, 46734, 46736, 46741, 46742, 46750, 46752, 46753, 46755, 46756, 46758, 46764, 46770, 46771, 46772, 46775, 46776, 46778, 46780, 46781, 46785, 46787, 46803, 46804, 46805, 46806, 46808, 46809, 46810, 46812, 46817, 46818, 46819, 46820, 46822, 46824, 46825, 46827, 46829, 46832, 46834, 46836, 46841, 46848, 46849, 46850, 46851, 46852, 46855, 46856, 46857, 46859, 46860, 46861, 46863, 46864, 46865, 46874, 46882, 46883, 46885, 46886, 46887, 46889, 46890, 46891, 46892, 46893, 46898, 46900, 46905, 46906, 46907, 46908, 46909, 46910, 46912, 46914, 46915, 46923, 46926, 46927, 46928, 46932, 46933, 46934, 46944, 46945, 46946, 46947, 46949, 46950, 46951, 46952, 46953, 46956, 46960, 46962, 46963, 46965, 46966, 46967, 46976, 46982, 46983, 46985, 46992, 46996, 46999, 47001, 47002, 47003, 47004, 47006, 47020, 47021, 47022, 47053, 47069, 47070, 47071, 47072, 47074, 47075, 47077, 47079, 47084, 47086, 47091, 47097, 47099, 47101, 47102, 47103, 47114, 47115, 47116, 47123, 47125, 47126, 47136, 47137, 47140, 47143, 47149, 47157, 47160, 47162, 47165, 47172, 47194, 47204, 47205, 47208, 47209, 47214, 47215, 47216, 47218, 47220, 47226, 47227, 47228, 47232, 47234, 47238, 47243, 47244, 47245, 47246, 47247, 47248, 47252, 47253, 47254, 47255, 47256, 47257, 47262, 47264, 47266, 47267, 47268, 47269, 47273, 47275, 47276, 47277, 47283, 47284, 47285, 47286, 47289, 47290, 47291, 47293, 47294, 47295, 47298, 47299, 47300, 47304, 47307, 47316, 47318, 47319, 47324, 47326, 47330, 47332, 47334, 47336, 47340, 47341, 47344, 47345, 47346, 47349, 47350, 47352, 47353, 47354, 47366, 47371, 47374, 47381, 47388, 47389, 47390, 47393, 47394, 47395, 47396, 47397, 47401, 47407, 47408, 47410, 47414, 47415, 47416, 47417, 47423, 47424, 47425, 47428, 47430, 47431, 47438, 47444, 47447, 47449, 47453, 47462, 47464, 47468, 47469, 47471, 47472, 47481, 47488, 47489, 47490, 47500, 47502, 47505, 47516, 47517, 47518, 47520, 47521, 47522, 47524, 47525, 47526, 47527, 47528, 47529, 47530, 47531, 47534, 47537, 47544, 47548, 47554, 47561, 47563, 47570, 47573, 47574, 47576, 47577, 47582, 47583, 47587, 47588, 47589, 47590, 47591, 47592, 47593, 47594, 47595, 47596, 47597, 47600, 47601, 47602, 47606, 47609, 47610, 47612, 47613, 47614, 47615, 47616, 47618, 47619, 47620, 47621, 47622, 47623, 47627, 47632, 47634, 47646, 47647, 47648, 47650, 47653, 47664, 47665, 47668, 47686, 47700, 47703, 47707, 47710, 47711, 47715, 47716, 47726, 47728, 47737, 47740, 47741, 47759, 47822, 47823, 47832, 47842, 47848, 47869, 47870, 47872, 47873, 47885, 47889, 47891, 47892, 47893, 47922, 47924, 47925, 47928, 47931, 47948, 47951, 47954, 47956, 47957, 47963, 47965, 47968, 47981, 47983, 47984, 47986, 47987, 47988, 47990, 47991, 47992, 47993, 47994, 47995, 47996, 47997, 47998, 47999, 48001, 48002, 48006, 48007, 48009, 48011, 48016, 48017, 48018, 48020, 48023, 48033, 48039, 48040, 48044, 48045, 48047, 48049, 48050, 48052, 48055, 48059, 48060, 48064, 48065, 48069, 48070, 48078, 48082, 48084, 48087, 48093, 48094, 48095, 48096, 48106, 48110, 48111, 48112, 48113, 48115, 48117, 48118, 48119, 48121, 48122, 48123, 48124, 48125, 48126, 48127, 48129, 48130, 48134, 48135, 48138, 48140, 48141, 48144, 48148, 48153, 48163, 48166, 48175, 48199, 48217, 48229, 48236, 48238, 48254, 48263, 48269, 48326, 48327, 48328, 48329, 48339, 48340, 48341, 48355, 48356, 48358, 48359, 48360, 48361, 48373, 48426, 48427, 48429, 48431, 48432, 48434, 48520, 48521, 48529, 48600, 48694, 48696, 48729, 48951, 48956, 48968, 49150, 49158, 49191, 49454, 49455, 49624, 49682, 49708, 49710, 49711, 49791, 49792, 49793, 49869, 49870, 49871, 49891, 49894, 49895, 49896, 49900, 49901, 49951, 49957, 49979, 49993, 50023, 50024, 50032, 50096, 50243, 50268, 50300, 50363, 50378, 50382, 50410, 50416, 50420, 50448, 50487, 50512, 50567, 50585, 50631, 50647, 50710, 50724, 50814, 50817, 50818, 50819, 50847, 50962, 50963, 51135, 51168, 51213, 51225, 51265, 51592, 51663, 51691, 51701, 51707, 51921, 51924, 51928, 51930, 51931, 51934, 51941, 52134, 52137, 52282, 52309, 52343, 52370, 52410, 52513, 52524, 52550, 52551, 52554, 52565, 52566, 52567, 52629, 52630, 52631, 52718, 52719, 52785, 52804, 52805, 52806, 52858, 52859, 52880, 52882, 52929, 52937, 52938, 53011, 53122, 53133, 53248, 53250, 53253, 53254, 53272, 53284, 53287, 53306, 53310, 53311, 53318, 53347, 53424, 53448, 53478, 53485, 53669, 53709, 53721, 53762, 53781, 53899, 54049, 54149, 54152, 54153, 54154, 54155, 54156, 54161, 54165, 54240, 54245, 54301, 54302, 54313, 54318, 54402, 54410, 54469, 54580, 54591, 54604, 54606, 54608, 54673, 54674, 54693, 54696, 54697, 54698, 54716, 54887, 54900, 54901, 54902, 54904, 54905, 54906, 54908, 54909, 54910, 54911, 54956, 55050, 55080, 55116, 55119, 55176, 55178, 55181, 55317, 55341, 55388, 55411, 55550, 55552, 55555, 55560, 55566, 55570, 55572, 55575, 55576, 55678, 55681, 55685, 55731, 55834, 55937, 55996)

PATTERN = re.compile(r'(?<!\\)(u[0-9a-f]{4})')
REPLACEMENT_PATTERN = r'\\\g<1>'
SKIP_CODES = [
    # Resolves to ? or a box
    'uebec', # quebec
    'udade', # ciudades
    'udada',
    'uebed',
    'uedbe',
    'ufffe',
    'ueced',
    'uecef',
    'uecec',
    'ueada',
    'uedde',
    'uedba',
    'uedde',
    'uebea',
    'ufabc',
    'ueeee',
    'uedda',
] + [
    # UnicodeEncodeError: surrogates not allowed
    #   Some maps like YTlfTVZ- have surrogates, like ud83dudcbb
    #       this is obviously a set of emoji or symbols, but Python won't do it for some reason
    'udeba',
    'udeca',
    'udeda',
    'udabe',
    'udace',
    'udafa',
    'ude23',
    'uddad',
    'ude64',
    'uddaa',
    'udebe',
    'uda3e',
    'ud83d',
    'udc49',
    'udc4c',
    'udffc',
    'udfff',
    'ude09',
    'ude02',
    'ude06',
    'ude8d',
    'udeeb',
    'udee9',
    'udd25',
    'udcd6',
    'udecd',
    'ude87',
    'udd11',
    'udd3c',
    'ude8a',
    'ude86',
    'ude97',
    'udee7',
    'ude89',
    'ude84',
    'ude8c',
    'udd01',
    'ude9f',
    'udd3d',
    'udcbb',
    'udea1',
    'ude8b',
    'ude9d',
    'udef3',
    'ude83',
    'udcfa',
    'udebd',
]

def replace_if_valid(text):

    """ If the text matches one of the SKIP_CODES, return it as-is,
            otherwise prepend with backslash

        # EXAMPLE: Map #44710 should not have any replacements done, it only has "Quebec" (uebec)
    """

    text = text.group(0)
    if text in SKIP_CODES:
        return text
    else:
        return f'\\{text}'

class Command(BaseCommand):

    help = """
        When I switched to MySQL, I didn't realize at first
        I also needed to set the CHARACTER SET on individual columns
        and not just on the table itself:

        ALTER TABLE map_saver_savedmap DEFAULT CHARACTER SET utf8mb4,
          MODIFY mapdata LONGTEXT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
          MODIFY stations LONGTEXT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL,
          MODIFY name varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL;

        This is done now so maps created from this point will not have this problem,
        but I need to go back through maps that had their data corrupted,
        where umlauts are stored as u00f6, u00fc, and similar. (Note the lack of backslash.)
        Not all code points / emoji (even 4-byte) were affected, which led me to overlook the issue during migration.

        THIS IS THE FINAL STEP OF A LARGELY MANUAL PROCESS
        THAT LOOKED AT THESE CHARACTERS WITHIN THE GREATER CONTEXT OF THE MAPS.
        THIS MERELY CONVERTS u00f6 AND FRIENDS TO THE LITERAL, ACTUAL TEXT \u00f6 (and friends)
    """

    def handle(self, *args, **kwargs):

        self.stdout.write(f"{len(corrupted_maps)} maps will be uncorrupted")

        for corrupted_map in corrupted_maps:

            try:
                corrupted_map = SavedMap.objects.get(id=corrupted_map)
            except Exception:
                self.stdout.write(f'SKIPPING {corrupted_map} -- NOT FOUND')
            else:
                fixed_map = re.sub(PATTERN, replace_if_valid, corrupted_map.mapdata)
                if corrupted_map.mapdata != fixed_map:
                    self.stdout.write(f'FIXING MAP #{corrupted_map.id} ({corrupted_map.urlhash})')
                    # self.stdout.write(f'[DEBUG] {re.sub(PATTERN, replace_if_valid, corrupted_map.mapdata)}')
                    # self.stdout.write('\n\n')
                    corrupted_map.mapdata = fixed_map
                    try:
                        corrupted_map.save()
                    except UnicodeEncodeError as err:
                        self.stdout.write(f'XXXXXXX ERROR: CHECK MAP #{corrupted_map.id} ({corrupted_map.urlhash}) -- UnicodeEncodeError: {err}')
                else:
                    self.stdout.write(f'......... OK: MAP #{corrupted_map.id} ({corrupted_map.urlhash}) DOES NOT NEED REPLACEMENTS')

        self.stdout.write(f"Finished uncorrupting {len(corrupted_maps)} maps.")
